# 实现登录注册功能计划

## 1. 数据库设计

### 1.1 用户表 (users)

| 字段名         | 数据类型         | 约束                                                                | 描述       |
| ----------- | ------------ | ----------------------------------------------------------------- | -------- |
| id          | INT          | PRIMARY KEY, AUTO\_INCREMENT                                      | 用户ID     |
| username    | VARCHAR(50)  | NOT NULL, UNIQUE                                                  | 账户昵称     |
| password    | VARCHAR(255) | NOT NULL                                                          | 密码（加密存储） |
| phone       | VARCHAR(20)  | NOT NULL, UNIQUE                                                  | 电话       |
| email       | VARCHAR(100) | NOT NULL, UNIQUE                                                  | 邮箱       |
| avatar      | VARCHAR(255) | DEFAULT NULL                                                      | 头像URL    |
| created\_at | DATETIME     | NOT NULL, DEFAULT CURRENT\_TIMESTAMP                              | 创建时间     |
| updated\_at | DATETIME     | NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP | 更新时间     |

### 1.2 笔记表 (notes)

| 字段名                  | 数据类型         | 约束                                         | 描述      |
| -------------------- | ------------ | ------------------------------------------ | ------- |
| id                   | VARCHAR(50)  | PRIMARY KEY                                | 笔记ID    |
| user\_id             | INT          | NOT NULL, FOREIGN KEY REFERENCES users(id) | 用户ID    |
| title                | VARCHAR(100) | NOT NULL                                   | 笔记标题    |
| content\_summary     | TEXT         | NOT NULL                                   | AI生成的摘要 |
| content\_long\_notes | LONGTEXT     | NOT NULL                                   | 笔记内容    |
| created\_at          | DATETIME     | NOT NULL                                   | 创建时间    |
| updated\_at          | DATETIME     | NOT NULL                                   | 更新时间    |

## 2. 后端服务开发

### 2.1 技术栈

* Node.js + Express + TypeScript

* MySQL 8.0

* JWT 认证

* bcrypt 密码加密

### 2.2 项目结构

```
backend/
├── src/
│   ├── config/          # 配置文件
│   │   └── database.ts  # 数据库连接配置
│   ├── controllers/     # 控制器
│   │   ├── authController.ts  # 认证相关
│   │   └── noteController.ts  # 笔记相关
│   ├── middleware/      # 中间件
│   │   └── authMiddleware.ts  # JWT 认证中间件
│   ├── models/          # 数据模型
│   │   ├── user.ts      # 用户模型
│   │   └── note.ts      # 笔记模型
│   ├── routes/          # 路由
│   │   ├── authRoutes.ts  # 认证路由
│   │   └── noteRoutes.ts  # 笔记路由
│   ├── services/        # 服务层
│   │   ├── authService.ts  # 认证服务
│   │   └── noteService.ts  # 笔记服务
│   ├── types/           # 类型定义
│   ├── utils/           # 工具函数
│   │   ├── jwt.ts       # JWT 工具
│   │   └── password.ts  # 密码加密工具
│   └── app.ts           # 应用入口
├── .env                 # 环境变量
├── package.json         # 依赖配置
└── tsconfig.json        # TypeScript 配置
```

### 2.3 API 设计

#### 认证 API

* `POST /api/auth/register` - 用户注册

* `POST /api/auth/login` - 用户登录

* `GET /api/auth/me` - 获取当前用户信息

#### 笔记 API

* `GET /api/notes` - 获取当前用户的所有笔记

* `GET /api/notes/:id` - 获取指定笔记

* `POST /api/notes` - 创建新笔记

* `PUT /api/notes/:id` - 更新笔记

* `DELETE /api/notes/:id` - 删除笔记

## 3. 前端功能开发

### 3.1 状态管理

* 添加用户状态管理

* 添加登录状态管理

* 使用 React Context 或自定义 Hook 管理全局状态

### 3.2 组件开发

#### 3.2.1 登录注册组件

* `LoginModal.tsx` - 登录模态框

* `RegisterModal.tsx` - 注册模态框

#### 3.2.2 用户信息组件

* `UserAvatar.tsx` - 用户头像组件（右上角）

* `UserDropdown.tsx` - 用户信息下拉菜单

### 3.3 服务层修改

* 修改 `noteService.ts` - 从数据库获取笔记

* 添加 `authService.ts` - 处理用户认证

### 3.4 路由设计

* 登录状态下：显示正常应用界面

* 未登录状态下：显示登录提示或强制跳转登录

### 3.5 样式设计

* 登录注册表单样式

* 用户头像和下拉菜单样式

* 响应式设计适配移动端

## 4. 实现步骤

### 4.1 数据库创建

1. &#x20;MySQL 8.0 数据库 `notes已经创建。需要连接数据库，账户root，密码root，写到环境变量中。`
2. 创建 `users` 表
3. 创建 `notes` 表

### 4.2 后端开发

1. 初始化 Node.js + TypeScript 项目
2. 配置数据库连接
3. 实现用户认证服务
4. 实现笔记服务
5. 启动后端服务

### 4.3 前端开发

1. 添加用户状态管理
2. 开发登录注册组件
3. 开发用户头像和下拉菜单组件
4. 修改 `noteService.ts` 连接后端 API
5. 集成登录注册功能到主应用

### 4.4 测试和集成

1. 测试登录注册功能
2. 测试笔记 CRUD 功能
3. 测试用户信息显示
4. 测试响应式设计
5. 修复 bug 和优化

## 5. 技术要点

### 5.1 安全考虑

* 密码使用 bcrypt 加密存储

* 使用 JWT 进行身份认证

* 实现 CSRF 防护

* 输入验证和 sanitization

### 5.2 性能考虑

* 数据库索引优化

* API 响应缓存

* 前端状态管理优化

### 5.3 用户体验

* 友好的登录注册表单

* 清晰的错误提示

* 流畅的动画效果

* 响应式设计

## 6. 预期效果

1. 用户可以通过手机号和密码进行登录
2. 用户可以注册新账户，需要提供昵称、密码、电话和邮箱
3. 登录后用户头像显示在页面右上角
4. 鼠标滑动到头像可以查看用户信息
5. 笔记数据存储到 MySQL 数据库
6. 登录用户只能查看和管理自己的笔记

## 7. 后续扩展

1. 支持头像上传功能
2. 支持忘记密码功能
3. 支持第三方登录
4. 支持笔记分享功能
5. 支持笔记分类和标签功能

